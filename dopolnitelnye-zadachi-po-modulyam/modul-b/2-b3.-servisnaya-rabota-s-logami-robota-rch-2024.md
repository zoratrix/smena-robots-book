# 2 Б3. Сервисная работа с логами робота (РЧ 2024)

Архив с лог файлами: [https://disk.yandex.ru/d/dhwIy0v5JSKUAg](https://disk.yandex.ru/d/dhwIy0v5JSKUAg)

Администрирование лог файлов. Необходимо написать скрипты/программы (один скрипт/программа на одну задачу) для управления логами, которые будут выполнять следующие задачи:

1. Используя лог файлы из директории 088820f4-060a-11ee-b33d-dca632e68beb посчитать сколько раз робот выполнил полный цикл патрулирования. Вывод скрипта/программы должен показать конкретное число;
2. Используя лог файлы из директории 25c90b8e-b1d6-11ed-a125-e45f0157ab9f необходимо составить текстовый файл с табличными данными, где:
   1. в первом столбце будет указан номер картины;
   2. в втором столбце будет указан номер aruco-маркера, который соответствует этой картине;
   3. в третьем столбце будет указано название картины и автор;
   4. не должно быть одинаковых строчек.

Пример:

<figure><img src="../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

Самые простые решения:

<details>

<summary>Часть 1. Посчитать сколько раз робот выполнил полный цикл патрулирования</summary>

```python
file = open("путь к файлу")           #открываем файл. python видит его как массив строк
counter = 0                           #нужно посчитать циклы, поэтому создаем счетчик (изначально = 0)
for line in file:                     # для каждой строки в файле
    if('Goal reached Goal6' in line): #если в строке есть нужный текст
        counter = counter+1           # то прибавить к счетчику +1
print(counter)                        #в конце вывести счетчик
```



</details>

<details>

<summary>Часть 2. Необходимо составить текстовый файл с табличными данными</summary>



</details>



Решения от ИИ:

Решение 1.

<details>

<summary>Решение 1.</summary>



Можно просто посчитать, сколько раз робот достиг **первой точки (Goal1)** после **последней точки (Goal6)**. Это и будет количеством полных циклов.

#### Упрощенный алгоритм:

1. Найти все строки с `"Patrol: Goal reached Goal1"`.
2. Учесть только те случаи, когда перед `Goal1` был `Goal6` (то есть робот завершил цикл).
3. Общее количество таких вхождений — это число полных циклов.

#### Решение (простой Python-скрипт):

```python
with open('turtlebro_patrol-3.txt', 'r') as file:
    logs = file.readlines()

# Список всех достигнутых целей в порядке появления
goals = []
for line in logs:
    if "Patrol: Goal reached" in line:
        goal = line.split("Goal reached ")[1].strip()
        goals.append(goal)

# Считаем, сколько раз после Goal6 идет Goal1 (завершение цикла)
cycle_count = 0
for i in range(1, len(goals)):
    if goals[i] == "Goal1" and goals[i-1] == "Goal6":
        cycle_count += 1

print(f"Робот выполнил полный цикл патрулирования {cycle_count} раз(а).")
```

#### Вывод:

Скрипт выдаст что-то вроде:

```
Робот выполнил полный цикл патрулирования 10 раз(а).
```

</details>

Решение 2

<details>

<summary>Решение 2</summary>



**максимально простой код** для задания Б (без лишних проверок, в одну функцию):

```python
# Читаем логи
with open('aruco_detect_server-1.txt') as f:
    markers = [line.split()[-1] for line in f if "Have marker result:" in line]

with open('speech_service-3.txt') as f:
    paintings = [line.split("Картина - ")[1].strip() for line in f if "Start speech:" in line]

# Собираем уникальные записи
data = set()
for i in range(min(len(markers), len(paintings))):
    name, author = paintings[i].split(". Автор - ")
    data.add((markers[i], name, author))

# Записываем в файл
with open('paintings_table.txt', 'w') as f:
    f.write("Маркер\tНазвание\tАвтор\n")
    for marker, name, author in sorted(data):
        f.write(f"{marker}\t{name}\t{author}\n")
```

#### Как это работает:

1. **Чтение логов**:
   * Из `aruco_detect_server-1.txt` вытаскиваем номера маркеров.
   * Из `speech_service-3.txt` вытаскиваем строки с названиями картин и авторами.
2. **Обработка**:
   * Разбиваем строки с картинами на название и автора.
   * Объединяем маркеры и картины по порядку (предполагая, что они идут синхронно).
3. **Запись результата**:
   * Удаляем дубликаты через `set()`.
   * Сортируем по номеру маркера и записываем в файл.

#### Результат (файл `paintings_table.txt`):

Copy

```
Маркер  Название                    Автор
11      Постоянство памяти          Сальвадор Дали
12      Черный квадрат              Каземир Малевич
13      Мона Лиза                   Леонардо Да Винчи
14      Девушка с жемчужной серёжкой Ян Вермеер
15      Сикстинская мадонна         Рафаэль Санти
16      Ночной дозор                Рембрандт
17      Купание красного коня       Кузьма Сергеевич Петров-Водкин
18      Последний день Помпеи       Карл Павлович Брюллов
```

</details>

